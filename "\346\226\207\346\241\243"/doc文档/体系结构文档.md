# Null And None电影院系统结构描述文档

# V1.0正式版

## 凉凉四人组

## 文档修改历史

| 修改人员 | 日期      | 修改原因 | 版本号 |
| :------: | --------- | -------- | ------ |
|  陆放明  | 2019-4-14 | 最初草稿 | V1.0.1   |
|  韩虚虹  | 2019-4-19 | 最初草稿新增用户界面层的分解 | V1.0.2  |
| 陆放明 | 2019-4-19 | 业务逻辑层分解 | V1.0.3 |
| 周    政 | 2019-4-19 | 数据层分解与信息视角 | V1.0.4 |
| 陆放明 | 2019-4-19 | 添加逻辑视图图片 | V1.0.5 |
| 杨云鹏 | 2019-4-20 | 接口控制层分解 | V1.0.5 |

## 目录

<html>

<ol>
    <li>引言 </li>
        1.1 编制目的<br>
        1.2 词汇表<br>
        1.3 参考资料<br>
    <li>产品概述</li>
    <li>逻辑视角</li>
    <li>组合视角</li>
        4.1 开发包图<br>
        4.2 运行时进城<br>
        4.3 物理部署<br>
    <li>接口视角</li>
        5.1 模块的职责<br>
        5.2 用户界面层的分解<br>
        		<ol>
            5.2.1 数据层模块的职责<br>
            5.2.2 数据层模块的接口规范<br>
            </ol>
        5.4 接口控制层的分解<br>
    		    		<ol>
            5.4.1 数据层模块的职责<br>
            5.4.2 数据层模块的接口规范<br>
            </ol>
    	5.5 业务逻辑层的分解<br>
    		    		<ol>
            5.5.1 数据层模块的职责<br>
            5.5.2 数据层模块的接口规范<br>
            </ol>
        5.6 数据访问层的分解<br>
     		<ol>
            5.6.1 数据层模块的职责<br>
            5.6.2 数据层模块的接口规范<br>
            </ol>
    	5.7 数据层的分解
            <ol>
            5.7.1 数据层模块的职责<br>
            5.7.2 数据层模块的接口规范<br>
            </ol>
    <li>信息视角</li>
        6.1 数据持久化对象<br>
        6.2 序列化持久化格式<br>
        6.3 数据库表<br>
</ol>

</html>

## 1.引言

### 1.1编制目的

本报告详细完成对电影院系统的概要设计，达到指导详细设计和开发的目的，同时实现测试人员及用户的沟通。

本报告面向开发人员、测试人员及最终用户编写，是了解系统的导航。

### 词汇表

|    词汇名称     | 词汇含义   | 备注               |
| :-------------: | ---------- | ------------------ |
|    audience     | 观众       |                    |
|     manager     | 经理       |                    |
|     account     | 账户       | 个人电影账户       |
|     signUp      | 注册       |                    |
|      login      | 登陆       |                    |
|       UI        | 界面       |                    |
|       BL        | 逻辑       |                    |
|       DAO       | 数据访问   | 对于数据的增删改查 |
| dataPersistence | 数据持久层 | 数据库数据         |
|     service     | 业务逻辑层 | 具体用例实现       |
|   controller    | 接口控制层 | 客户端交互实现     |



### 1.3 参考资料

1. Null And None电影院系统用例文档 V1.0
2. Null And None电影院系统需求规格说明文档 V1.0
3. 丁二玉，刘钦.计算与软件工程（卷二）[M]机械工业出版2012：134—182
4. IEEE std 1471-2000

## 2. 产品概述

参考《Null And None电影院系统》和《Null And None电影院系统需求规格说明文档》中对产品的描述。

## 3. 逻辑视图

- 处理静态设计模型

Null And None电影院系统中，选择了RestFul分层体系结构的风格，

将系统分为4层

- `UI展示层、接口控制层、业务逻辑层、数据访问层(DAO)、数据持久层`

- 能够很好的示意整个高层抽象。

- **UI展示层**包括UI页面的实现

- **接口控制层**包含服务器与客户端接口交互的实现

- **业务逻辑层**包含具体用例逻辑实现

- **数据访问层(DAO)**负责数据的访问

- **数据持久层**负责MySql数据到JAVA实体类的映射

  注：

  - 系统将VO层分解为接口控制层与业务逻辑层的共同职责
  - PO层分解为业务逻辑层与数据访问层的共同职责

  分层体系结构的逻辑视角和逻辑设计方案如图1和图2所示。

图1：分层结构（逻辑视角）

![](<https://github.com/1071956678lfm/NJUSE-2/blob/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E9%80%BB%E8%BE%91%E8%A7%86%E8%A7%92.png?raw=true>)



图2：逻辑设计方案

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE.png>)

## 4. 组合视图

### 4.1 开发包图

[软工2 166]与抽象的逻辑设计相比，实现物理设计要考虑更多的实现细节，这些细节有：<br>
1）所有的presentation层开发包都需要使用图形类型建立界面，都要依赖于图形界面类库包。<br>
2）在presentation层实现时，由mainUI包负责不同参与者在整个页面之间的跳转逻辑。其他各包负责各自页面自身的功能，并由各自的controller负责自身内部页面之间的跳转逻辑。<br>
3）presentation层被置于客户端，`接口控制层`、`业务逻辑层`、`数据访问层`和`数据持久层`被置于服务器端，那么presentation层的开发包不可能依赖于接口控制层的开发包。使用RMI技术，将后端架构层开发包分解为置于客户端的businessLogicService接口包和置于服务器端的业务逻辑层开发包。这样一来，presentation层开发包依赖于businessLogicService包，businessLogicService包依赖于RMI类库包。<br>
4）所有的数据访问层开发包都需要进行数据持久化（例如读写数据库、读写序列化文件等），所以它们会有一些重复代码，可以将重复代码独立为新的开发包，依赖JPA持久层框架，通过sql语句映射至JAVA语句，实现数据库数据的操作。<br>
5）在分层风格的典型设计中，不希望高层直接依赖于低层，而是为低层建立接口包，实现依赖倒置原则，所以应该调整为：各presentation层开发包（调用）依赖于logic层接口包businessLogicService包，businessLogic层开发包也依赖于（实现了）businessLogic层接口包businessLogicService包。<br>
6）在分层风格的典型设计中，presentation层与业务逻辑层之间、业务逻辑层与数据访问层之间可能会传递复杂数据对象，那么相邻两层都需要使用数据对象声明
7）使用依赖倒置原则消除包的循环依赖现象，将循环依赖变为单向依赖：<br>
<br>

8）在业务逻辑层中，初始化和业务逻辑层上下文的工作被分配到utility包中。<br>

界面层依据参与者分为main、登录界面和4个参与者主界面；逻辑层主要依据逻辑分包的结果，并添加logInBL，负责用户的登录和客户的注册；数据层进行整合合并，依照参与者、电影院账单、账的实际情况进行分类。<br>

|     开发包     | 依赖的其他开发包                                |
| :------------: | ----------------------------------------------- |
|     mainui     | userui、manageui、vo、clientui                  |
|    loginUI     | loginBLService,界面类库包,VO                    |
| stockManagerUI | loginBLService,commodityBLService,界面类库包,VO |
| loginBLService | Java RMI,VO                                     |
|                |                                                 |
|                |                                                 |



图3：客户端开发包图

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E7%B1%BB%E5%9B%BE.png>)



图4：服务器端开发包图

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE.png>)





### 4.2 运行时进程

- 在Null And None电影院系统中，会有多个客户端进程和一个服务器端进程，其进程图如下图所示。结合部署图，客户端进程是在客户端机器上运行，服务器端进程是在服务器端机器上运行。


图5：进程图

![图5进程图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/体系结构描述文档图/进程图.png)

### 4.3 物理部署

- 在Null And None电影院系统中客户端构件是放在客户端机上，服务器端构件是放在服务器端机器上。在客户端节点上，还要部署RMIStub构件。由于Java RMI 构件属于JDK1.8的一部分。所以，在系统JDK环境已经设置好的情况下，不需要独立部署。部署图如下图所示。

- 处理如何将软件组件映射到硬件基础设施

图6：部署图

![图6部署图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/体系结构描述文档图/部署图.png)

## 5. 架构设计

- 描述功能分解和如何在不同的层中安排软件模块
  - 描述架构中的对象，包含架构图
  - 描述组件接口信息
    - 包括：语法、前置条件、后置条件

### 5.1 模块职责

- 模块视图

客户端模块和服务器模块视图分别如图7和图8所示。

图7：客户端模块视图

![图7客户端模块视图](http://101.37.19.32:10080/161250181/ERPnju/raw/master/doc/md/体系结构描述文档图/客户端模块视图.png)

图8：服务端模块视图

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E5%9D%97%E8%A7%86%E5%9B%BE.png>)

**客户端各层的职责**

| 层             | 职责                                         |
| -------------- | -------------------------------------------- |
| 启动模块       | 负责初始化网络通信机制，启动用户界面         |
| 用户界面层     | 基于窗口的灯具公司进销存系统用户界面         |
| 业务逻辑层     | 对于用户界面的输入进行相应并进行业务处理逻辑 |
| 客户端网络模块 | 利用Java RMI机制查找RMI服务                  |

**服务器端各层的职责**

| 层         | 职责                               |
| ---------- | ---------------------------------- |
| 接口控制层 | 负责与客户端进行HTTP交互           |
| 业务逻辑层 | 负责用例复杂逻辑实现               |
| 数据访问层 | 负责处理数据的持久化及数据访问接口 |
| 数据持久层 | 负责数据库数据的映射               |

每一层只是使用下方直接接触的层。层与层之间仅仅是通过接口的调用来完成的。层之间调用的接口如下表所示。

- 层之间调用接口

| 接口                                                         | 服务调用方         | 服务提供方         |
| ------------------------------------------------------------ | ------------------ | ------------------ |
| loginBLService<br>commodityBLService<br>customerBLService<br>mainfestBLService<br>bankaccountBLService<br>reciptBLService<br>recordBLService<br>accountBLService<br>checkBLService<br>promotionBLService<br>userBLService<br> | 客户端展示层       | 服务器端业务逻辑层 |
| commodityDataService<br> customerDataService<br> mainfestDataService<br> bankaccountDataService<br> reciptDataService<br> recordDataService<br> accountDataService<br> checkDataService<br> promotionDataService<br> userDataService<br> | 服务器端业务逻辑层 | 服务器端数据层     |

每一层之间都是由上层依赖了一个接口（需接口），而下层实现这个接口（供接口）。

### 5.2 用户界面层分解
根据需求，系统存在28个用户界面：登陆界面、注册界面、用户首页界面、用户影库界面、快速购票界面、电影详情界面、观众选座购票界面、观众帮助界面、观众购买会员卡界面、观众查看会员卡消费记录、余额、充值界面、观众查看会员卡相关信息界面（级别、优惠）、观众个人中心主界面（基本信息）、观众更改基本信息界面、观众历史订单界面、退改票界面、观众查看优惠券会员卡界面、观众查看已标记喜爱电影界面、观众消息界面、管理员首页界面、管理员管理状态主界面（上架电影）、管理员管理排片界面、管理员发布优惠信息界面、数据统计界面、搜索结果界面、经理修改会员卡优惠界面、经理修改退票策略界面、经理影厅信息录入修改界面、经理修改影院角色界面、界面跳转如图9所示。

图9 用户界面跳转

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E8%B7%B3%E8%BD%AC%E5%9B%BE.png>)



用户界面类如图10所示。

图10 用户界面类

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E7%B1%BB%E5%9B%BE.png>)

#### 5.2.1 用户界面层模块的职责
模块 | 职责
---|---
MainFrame | 界面Frame，负责界面的显示和界面的跳转
LoginFrame | 界面Frame，负责登录界面的显示和观众/管理员/经理首页界面的跳转
RegisterFrame | 界面Frame，负责注册界面的显示和登录界面的跳转
UserUI.RefundFrame | 界面frame，负责观众退票界面的显示和跳转
UserUI.MainFrame | 界面Frame，负责观众主界面的跳转和观众的首页界面的显示
UserUI.MovieDatabaseFrame | 界面Frame，负责电影详情界面的跳转和影库信息的显示
UserUI.FastBookingFrame | 界面Frame，负责观众购票界面的跳转和观众快速购票的显示
UserUI.HelperFrame | 界面Frame，负责观众帮助导航的跳转和观众帮助的显示
UserUI.BuyVIPcardFrame | 界面Frame，负责观众付款界面的跳转和观众会员卡购买的显示
UserUI.CheckVIPcardFrame | 界面Frame，负责观众会员卡导航的跳转和观众查看会员卡相关信息页面的显示
UserUI.VIPcardCostFrame | 界面Frame，负责观众付款界面的跳转和观众会员卡购买的显示
UserUI.HomeFrame | 界面Frame，负责观众导航的跳转和观众个人中心首页的显示
UserUI.ChangeInformationFrame | 界面Frame，负责观众个人中心导航的跳转和观众修改个人信息界面的显示
UserUI.HistoryFrame | 界面Frame，负责观众个人中心导航界面的跳转和观众历史订单的显示
UserUI.CheckDiscountFrame | 界面Frame，负责观众个人中心导航界面的跳转和观众普通优惠信息的显示
UserUI.CheckMarkFrame | 界面Frame，负责观众电影详情的跳转和观众标记电影列表的显示
UserUI.MessageFrame | 界面Frame，负责观众消息界面的显示
AdministerUI.PutawayFrame|界面frame，负责管理人员管理电影排
片界面的显示和跳转
SelectFrame|界面frame，负责搜索结果到显示和影片详细信息到跳转
AdministerUI.MainFrame | 界面Frame，负责管理人员主界面的跳转和管理人员的首页界面的显示
AdministerUI.HomeFrame | 界面Frame，负责导航的跳转和管理人员的主界面的显示
AdministerUI.ScheduleFrame | 界面Frame，负责导航的跳转和管理人员管理电影排片界面的显示
AdministerUI.DiscountFrame | 界面Frame，负责导航的跳转和管理人员发布优惠信息的显示
AdministerUI.StatisticFrame | 界面Frame，负责导航的跳转和统计数据的显示
ManagerUI.MainFrame | 界面Frame，负责经理主界面的跳转和经理的首页界面的显示
ManagerUI.HomeFrame | 界面Frame，负责经理导航的跳转和经理的主界面的显示
ManagerUI.DiscountFrame | 界面Frame，负责导航的跳转和经理修改会员优惠策略界面的显示
ManagerUI.RefundFrame | 界面Frame，负责导航的跳转和经理修改观众退改票策略界面的显示
ManagerUI.MovieHallFrame | 界面Frame，负责导航的跳转和经理管理影厅信息界面的显示
ManagerUI.RoleFrame | 界面Frame，负责导航的跳转和经理修改影院角色界面的显示

- 接口规范
- 需要的服务接口

|         服务名         | 服务                   |
| :--------------------: | ---------------------- |
| blservice.loginservice | 登录界面的业务逻辑接口 |



#### 5.2.2 接口规范

| 接口名 | 语法         |
| ------ | :----------- |
|        | **前置条件** |
|        | **后置条件** |

### 5.3 接口控制层分解

#### 5.3.1 职责

接口控制层设计

![接口控制层设计](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%8E%A5%E5%8F%A3%E6%8E%A7%E5%88%B6%E5%B1%82%E8%AE%BE%E8%AE%A1.png>)
模块|职责
---|---
LoginController|提供普通用户与管理员的登陆、注册接口
scheduleController|提供排片相关的接口
VIPController|提供会员卡相关接口
TicketController|提供电影票（购买、退票等）相关接口
MovieHallController|提供影厅信息相关接口
MovieController|提供电影（上架、想看人数等）相关接口
AdministratorController|提供管理员其他相关接口
UserController|提供普通用户查看信息相关接口
ManagerController|提供经理操作接口

#### 5.3.2 接口规范

##### 凉凉四人组 的 API接口 1.0

目录

- [1. 概述](#_overview)
- [2. 接口](#_paths)
- [3. 数据结构](#_definitions)
- [4. 错误码](#_error_code)

## 1. 概述

### 1.1. 文档说明



### 1.2. 请求基路径

| 名称       | 基路径                               | 描述 | 状态 |
| ---------- | ------------------------------------ | ---- | ---- |
| 本地服务器 | http://localhost:18080/              |      | 启用 |
| 远端服务器 | http://106.14.140.93:8080/se-server/ |      | 启用 |

### 1.3. 公共请求参数

| 字段 | 参数位置 | 类型 | 默认值 | 必输项 | 描述 |
| ---- | -------- | ---- | ------ | ------ | ---- |
|      |          |      |        |        |      |

## 2. 接口

### 2.1. LoginController

用于不同用户登陆操作

#### 2.1.1. 用户登陆



##### 基本信息

- 请求url：`/userlogin`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`陆放明`
- 创建时间：`2019-03-19 23:53:13`
- 修改时间：`2019-04-19 14:30:56`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 是     | <[requestBody](#_inter_307609_param_json_schema_requestBody)> |      |

[requestBody]

{
  "account" : "string",
  "password" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_307609_resp_json_schema_ack)> |      |

[ack]

{
  "status" : 200,
  "message" : "string",
  "userId" : "string"
}



#### 2.1.2. 用户注册

用户注册

##### 基本信息

- 请求url：`/userRegister`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 14:24:18`
- 修改时间：`2019-04-19 14:32:23`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317207_param_json_schema_requestBody)> |      |

[requestBody]

{
  "account" : "string",
  "password" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317207_resp_json_schema_ack)> |      |

[ack]

{
  "status" : 200,
  "message" : "string"
}



#### 2.1.3. 退出登陆

登出

##### 基本信息

- 请求url：`/logout`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 创建时间：`2019-04-19 14:33:28`
- 修改时间：`2019-04-19 14:36:00`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317212_param_json_schema_requestBody)> |      |

[requestBody]

{
  "userId" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317212_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "int",
  "message" : "string"
}



### 2.2. ScheduleController

提供排片相关的接口

#### 2.2.1. 添加排片

添加排片

##### 基本信息

- 请求url：`/schedule/add`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 标签：`排片`
- 创建时间：`2019-04-19 14:41:41`
- 修改时间：`2019-04-19 14:41:41`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317219_param_json_schema_requestBody)> |      |

[requestBody]

{
  "movieHallId" : "string",
  "movieId" : "string",
  "price" : "double",
  "date" : "int"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317219_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "string",
  "message" : "string"
}



#### 2.2.2. 删除排片

删除排片

##### 基本信息

- 请求url：`/schedule/delete`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 14:44:33`
- 修改时间：`2019-04-19 14:44:33`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317220_param_json_schema_requestBody)> |      |

[requestBody]

{
  "movieHallId" : "string",
  "date" : "int"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317220_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "string",
  "message" : "string"
}



#### 2.2.3. 修改排片信息

修改排片

##### 基本信息

- 请求url：`/schedule/change`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 14:45:35`
- 修改时间：`2019-04-19 14:46:20`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317222_param_json_schema_requestBody)> |      |

[requestBody]

{
  "movieHallId" : "string",
  "movieId" : "string",
  "price" : "double",
  "date" : "int"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317222_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "string",
  "message" : "string"
}



#### 2.2.4. 查找排片

修改排片

##### 基本信息

- 请求url：`/schedule/select`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 14:50:46`
- 修改时间：`2019-04-19 14:52:04`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317224_param_json_schema_requestBody)> |      |

[requestBody]

{
  "movieHallId" : "string",
  "view" : "string, 查看排片视角"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317224_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "string",
  "message" : "string",
  "movieList" : [ ]
}



#### 2.2.5. 设置排片信息观众可见时间



##### 基本信息

- 请求url：`/schedule/setTime`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 22:23:30`
- 修改时间：`2019-04-19 22:28:41`

##### 请求参数

| 字段 | 参数位置 | 类型 | 默认值 | 必输项 | 结构 | 描述 |
| ---- | -------- | ---- | ------ | ------ | ---- | ---- |
|      |          |      |        |        |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317291_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.2.6. 修改排片信息观众可见时间



##### 基本信息

- 请求url：`/schedule/changeTime`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 22:33:06`
- 修改时间：`2019-04-19 22:46:39`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317292_param_json_schema_requestBody)> |      |

[requestBody]

{
  "date" : "int"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317292_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



### 2.3. VIPController

提供会员卡相关接口

#### 2.3.1. 购买会员卡



##### 基本信息

- 请求url：`/vip/purchase`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 22:51:29`
- 修改时间：`2019-04-19 22:51:29`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317293_param_json_schema_requestBody)> |      |

[requestBody]

{
  "userId" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317293_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.3.2. 查看会员卡余额



##### 基本信息

- 请求url：`/vip/select`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 22:54:15`
- 修改时间：`2019-04-19 23:05:26`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317294_param_json_schema_requestBody)> |      |

[requestBody]

{
  "userId" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317294_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.3.3. 充值会员卡



##### 基本信息

- 请求url：`/vip/recharge`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 22:57:55`
- 修改时间：`2019-04-19 22:57:55`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317295_param_json_schema_requestBody)> |      |

[requestBody]

{
  "userId" : "string",
  "money" : "double"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317295_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.3.4. 发布会员卡



##### 基本信息

- 请求url：`/vip/release`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:05:12`
- 修改时间：`2019-04-19 23:09:37`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317298_param_json_schema_requestBody)> |      |

[requestBody]

{
  "example" : "type,description"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317298_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.3.5. 修改会员卡优惠策略



##### 基本信息

- 请求url：`/vip/change`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:14:33`
- 修改时间：`2019-04-19 23:14:33`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317299_param_json_schema_requestBody)> |      |

[requestBody]

{
  "example" : "type,description"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317299_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



### 2.4. TicketController

提供电影票（购买、退票等）相关接口

#### 2.4.1. 买票



##### 基本信息

- 请求url：`/ticket/purchase`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:16:27`
- 修改时间：`2019-04-19 23:16:27`

##### 请求参数

| 字段 | 参数位置 | 类型 | 默认值 | 必输项 | 结构 | 描述 |
| ---- | -------- | ---- | ------ | ------ | ---- | ---- |
|      |          |      |        |        |      |      |



##### 请求响应

| 名称 | 类型 | 默认 | 结构 | 描述 |
| ---- | ---- | ---- | ---- | ---- |
|      |      |      |      |      |





#### 2.4.2. 退票



##### 基本信息

- 请求url：`/ticket/refund`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:38:23`
- 修改时间：`2019-04-19 23:38:23`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317301_param_json_schema_requestBody)> |      |

[requestBody]

{
  "movieScheduleId" : "string",
  "number" : "int",
  "userId" : "string",
  "positions" : "[]"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317301_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.4.3. 新增退票策略



##### 基本信息

- 请求url：`/ticket/refundPolicy/add`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:42:06`
- 修改时间：`2019-04-19 23:42:06`

##### 请求参数

| 字段 | 参数位置 | 类型 | 默认值 | 必输项 | 结构 | 描述 |
| ---- | -------- | ---- | ------ | ------ | ---- | ---- |
|      |          |      |        |        |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317302_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.4.4. 修改退票策略



##### 基本信息

- 请求url：`/ticket/refundPolicy/change`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:43:41`
- 修改时间：`2019-04-19 23:44:12`

##### 请求参数

| 字段 | 参数位置 | 类型 | 默认值 | 必输项 | 结构 | 描述 |
| ---- | -------- | ---- | ------ | ------ | ---- | ---- |
|      |          |      |        |        |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317303_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



### 2.5. MovieHallController

提供影厅信息相关接口

#### 2.5.1. 录入影厅信息



##### 基本信息

- 请求url：`/MovieHall/add`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:45:53`
- 修改时间：`2019-04-19 23:49:56`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317304_param_json_schema_requestBody)> |      |

[requestBody]

{
  "name" : "string",
  "size" : "int",
  "positions" : "[]"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317304_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.5.2. 修改影厅信息



##### 基本信息

- 请求url：`/MovieHall/change`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 责任人：`杨云鹏`
- 创建时间：`2019-04-19 23:50:49`
- 修改时间：`2019-04-19 23:51:39`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317305_param_json_schema_requestBody)> |      |

[requestBody]

{
  "name" : "string",
  "size" : "int",
  "positions" : "[]"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317305_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



### 2.6. MovieController

提供电影（上架、想看人数等）相关接口

#### 2.6.1. 统计全部电影的想看人数



##### 基本信息

- 请求url：`/movie/wanted/all`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 09:24:07`
- 修改时间：`2019-04-20 09:24:22`

##### 请求参数

| 字段 | 参数位置 | 类型 | 默认值 | 必输项 | 结构 | 描述 |
| ---- | -------- | ---- | ------ | ------ | ---- | ---- |
|      |          |      |        |        |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317308_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "stirng"
}



#### 2.6.2. 统计某部电影想看人数



##### 基本信息

- 请求url：`/movie/wanted`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`GET`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 创建时间：`2019-04-20 09:28:40`
- 修改时间：`2019-04-20 09:28:40`

##### 请求参数

| 字段    | 参数位置 | 类型   | 默认值 | 必输项 | 结构 | 描述 |
| ------- | -------- | ------ | ------ | ------ | ---- | ---- |
| movieId | query    | string |        | 否     |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317309_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string",
  "numberOfwanted" : "[]"
}



#### 2.6.3. 查看电影列表



##### 基本信息

- 请求url：`/movie/list`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 创建时间：`2019-04-20 09:31:22`
- 修改时间：`2019-04-20 09:31:22`

##### 请求参数

| 字段 | 参数位置 | 类型 | 默认值 | 必输项 | 结构 | 描述 |
| ---- | -------- | ---- | ------ | ------ | ---- | ---- |
|      |          |      |        |        |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317310_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string",
  "movieInfo" : "[]"
}



#### 2.6.4. 查看电影详情



##### 基本信息

- 请求url：`/movie/detail`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`GET`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 创建时间：`2019-04-20 09:34:32`
- 修改时间：`2019-04-20 09:34:32`

##### 请求参数

| 字段    | 参数位置 | 类型   | 默认值 | 必输项 | 结构 | 描述 |
| ------- | -------- | ------ | ------ | ------ | ---- | ---- |
| movieid | query    | string |        | 否     |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317311_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.6.5. 标记想看



##### 基本信息

- 请求url：`/movie/wanted/mark`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 09:37:31`
- 修改时间：`2019-04-20 09:37:31`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317315_param_json_schema_requestBody)> |      |

[requestBody]

{
  "movieId" : "stirng",
  "userId" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317315_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.6.6. 搜索电影



##### 基本信息

- 请求url：`/movie/search`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 09:39:45`
- 修改时间：`2019-04-20 09:40:46`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317317_param_json_schema_requestBody)> |      |

[requestBody]

{
  "keyword" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317317_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string",
  "searchResult" : "[]"
}



### 2.7. AdministratorController

管理员其他相关接口

#### 2.7.1. 查看统计数据



##### 基本信息

- 请求url：`/statistic`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 09:55:23`
- 修改时间：`2019-04-20 09:55:23`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317321_param_json_schema_requestBody)> |      |

[requestBody]

{
  "statistic" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317321_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string",
  "statistic" : "[]"
}



#### 2.7.2. 发布优惠活动



##### 基本信息

- 请求url：`/discount`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 10:03:08`
- 修改时间：`2019-04-20 10:03:08`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317323_param_json_schema_requestBody)> |      |

[requestBody]

{
  "deadline" : "int",
  "money" : "int",
  "condition" : "int,必须要满多少钱才能使用"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317323_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



### 2.8. UserController

普通用户查看信息相关接口

#### 2.8.1. 查看历史充值记录



##### 基本信息

- 请求url：`/user/deposit/histroy`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`GET`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 10:09:02`
- 修改时间：`2019-04-20 10:09:02`

##### 请求参数

| 字段   | 参数位置 | 类型   | 默认值 | 必输项 | 结构 | 描述 |
| ------ | -------- | ------ | ------ | ------ | ---- | ---- |
| userId | query    | string |        | 否     |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317324_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string",
  "record" : "[]"
}



#### 2.8.2. 查看历史消费记录



##### 基本信息

- 请求url：`/user/consume/histroy`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`GET`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 10:10:26`
- 修改时间：`2019-04-20 10:11:01`

##### 请求参数

| 字段   | 参数位置 | 类型   | 默认值 | 必输项 | 结构 | 描述 |
| ------ | -------- | ------ | ------ | ------ | ---- | ---- |
| userId | query    | string |        | 否     |      |      |



##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317325_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string",
  "record" : "[]"
}



### 2.9. ManagerController

经理操作接口

#### 2.9.1. 增加管理员



##### 基本信息

- 请求url：`/administrator/add`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 10:18:49`
- 修改时间：`2019-04-20 10:18:49`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317327_param_json_schema_requestBody)> |      |

[requestBody]

{
  "account" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317327_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.9.2. 删除管理员



##### 基本信息

- 请求url：`/administrator/delete`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 开发状态：`开发中`
- 创建时间：`2019-04-20 10:19:19`
- 修改时间：`2019-04-20 10:21:37`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317328_param_json_schema_requestBody)> |      |

[requestBody]

{
  "account" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317328_resp_json_schema_ack)> |      |

[ack]

{
  "status" : "200",
  "message" : "string"
}



#### 2.9.3. 查看管理员账号信息



##### 基本信息

- 请求url：`/administrator`
- 是否弃用：`否`
- 是否忽略公共请求参数：`否`
- 请求协议：`HTTP`
- 请求方式：`POST`
- 请求格式：`application/json`
- 响应格式：`application/json`
- 创建时间：`2019-04-20 10:24:30`
- 修改时间：`2019-04-20 10:24:30`

##### 请求参数

| 字段        | 参数位置 | 类型      | 默认值 | 必输项 | 结构                                                         | 描述 |
| ----------- | -------- | --------- | ------ | ------ | ------------------------------------------------------------ | ---- |
| requestBody | body     | cust_json |        | 否     | <[requestBody](#_inter_317331_param_json_schema_requestBody)> |      |

[requestBody]

{
  "account" : "string"
}

##### 请求响应

| 名称 | 类型      | 默认 | 结构                                         | 描述 |
| ---- | --------- | ---- | -------------------------------------------- | ---- |
| ack  | cust_json | 否   | <[ack](#_inter_317331_resp_json_schema_ack)> |      |

[ack]

{
  "isAdministrator" : "bool"
}



## 3. 数据结构

### 3.1. LoginController

### 3.2. ScheduleController

### 3.3. VIPController

### 3.4. TicketController

### 3.5. MovieHallController

### 3.6. MovieController

### 3.7. AdministratorController

### 3.8. UserController

### 3.9. ManagerController

## 4. 错误码

| 返回码 | 返回信息 | 说明 |
| ------ | -------- | ---- |
| 123    | 查       |      |

生成时间：2019-04-20 11:05:14

### 5.4 业务逻辑层分解

#### 5.4.1 职责

##### 5.4.1.1 具体职能

接受接口控制层的请求，处理复杂的用例事件，来完成上层的行为；

同时将用例事件细化到数据持久化层的操作，指派下层任务

##### 5.4.1.2 业务逻辑层的设计

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E8%AE%BE%E8%AE%A1.png>)

##### 5.4.1.3 业务逻辑层的模块的职责

| 模块                | 职责                                       |
| ------------------- | ------------------------------------------ |
| UserInfoService     | 负责用户信息管理所需要的服务               |
| UserService         | 负责用户登陆、注册、登出操作所需要的服务   |
| MovieService        | 负责电影信息管理、电影信息检索所需要的服务 |
| MemberService       | 负责会员信息管理所需要的服务               |
| FavorService        | 负责管理想看电影所需要的服务               |
| MovieArrangeService | 负责排片用例所需要的服务                   |
| MovieSumService     | 负责电影信息统计的服务                     |
| HallService         | 负责电影院信息管理的服务                   |
| TicketService       | 负责电影票管理的服务                       |
| RoleService         | 负责用户角色信息管理的服务                 |
| PermissionService   | 负责角色权限管理的服务                     |
| PreferentialService | 负责优惠管理的服务                         |



#### 5.4.2 接口规范
<table>
    	<tr>
            <th colspan="3">UserService</td>
        </tr>
        <tr>
          <th rowspan="3">UserService.login</th>
          <td>语法</td>
          <td>public JSONObject login(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户进入网页，并且用户账户存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统跳转到对应网页主界面</td>
        </tr>
		<tr>
          <th rowspan="3">UserService.logout</th>
          <td>语法</td>
          <td>public void logout(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户已登录</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统跳转到未登录主界面</td>
        </tr>
    	<tr>
          <th rowspan="3">UserService.register</th>
          <td>语法</td>
          <td>public response resigter(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户已输入相关注册信息，并且注册信息符合系统输入规范</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统跳转到登陆状态</td>
        </tr>
<table>
    	<tr>
            <th colspan="3">UserInfoService</td>
        </tr>
        <tr>
          <th rowspan="3">UserInfoService.getUserInfo</th>
          <td>语法</td>
          <td>public response getUserInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户已登录，并且已经编辑了相关的个人信息内容</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回用户个人信息，显示在UI界面</td>
        </tr>
        <tr>
          <th rowspan="3">UserInfoService.insertUserInfo</th>
          <td>语法</td>
          <td>public response insertUserInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已登录用户输入内容合法</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统插入用户信息，并且在UI界面上及时更新</td>
        </tr>
        <tr>
          <th rowspan="3">UserInfoService.updateUserInfo</th>
          <td>语法</td>
          <td>public response updateUserInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已登录用户输入内容合法</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统更新用户信息，并且在UI界面上及时更新</td>
        </tr>
        <tr>
          <th rowspan="3">UserInfoService.deleteUserInfo</th>
          <td>语法</td>
          <td>public response deleteUserInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已登录用户所要删除的个人信息存在，并且允许被删除</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统去除用户信息，并且在UI界面上及时更新</td>
        </tr>
        <tr>
          <th rowspan="3">UserInfoService.getUserFavorList</th>
          <td>语法</td>
          <td>public response getUserFavorList(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>已登录用户拥有相关的想看电影信息</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统得到用户想看电影列表并且返回</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">MovieService</td>
        </tr>
        <tr>
          <th rowspan="3">MovieService.getMovieInfo</th>
          <td>语法</td>
          <td>public response getMovieInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员/普通观众登陆</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统查询电影信息，并且在UI界面上及时更新</td>
        </tr>
        <tr>
          <th rowspan="3">MovieService.insertMovieRecord</th>
          <td>语法</td>
          <td>public response insertMovieRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，所要上架的电影所输入的电影信息合法</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统插入电影信息</td>
        </tr>
        <tr>
          <th rowspan="3">MovieService.updateMovieRecord</th>
          <td>语法</td>
          <td>public response updateMovieRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，输入的电影信息合法</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统修改电影信息</td>
        </tr>
        <tr>
          <th rowspan="3">MovieService.deleteMovieRecord</th>
          <td>语法</td>
          <td>public response deleteMovieRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，所要删除下架的电影存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统下架电影，并且返回结果</td>
        </tr>
        <tr>
          <th rowspan="3">MovieService.setLookableTime</th>
          <td>语法</td>
          <td>public response deleteMovieRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，所操作的电影存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统设置电影排片，对于普通用户可查看时间</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统下架电影，并且返回结果</td>
        </tr>
        <tr>
          <th rowspan="3">MovieService.setLookableTime</th>
          <td>语法</td>
          <td>public response deleteMovieRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，所操作的电影存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统设置电影排片，对于普通用户可查看时间</td>
        </tr>
        <tr>
          <th rowspan="3">MovieService.updateLookableTime</th>
          <td>语法</td>
          <td>public response updateMovieRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，所操作的电影存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统修改电影排片，对于普通用户可查看时间</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">MemberService</td>
        </tr>
        <tr>
          <th rowspan="3">MemberService.selectMemberInfo</th>
          <td>语法</td>
          <td>public response selectMemberInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>普通用户登陆</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回会员信息</td>
        </tr>
        <tr>
          <th rowspan="3">MemberService.addMemberInfo</th>
          <td>语法</td>
          <td>public response addMemberInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，所操作的用户存在并且不为会员</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统设置该用户的角色为会员，赋予相关优惠权限</td>
        </tr>
        <tr>
          <th rowspan="3">MemberService.updateMemberInfo</th>
          <td>语法</td>
          <td>public response updateMemberInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员角色操作，修改会员角色优惠</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统修改会员角色优惠</td>
        </tr>
        <tr>
          <th rowspan="3">MemberService.deleteMemberInfo</th>
          <td>语法</td>
          <td>public response updateMemberInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户会员到期</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统取消用户的会员角色</td>
        </tr>
        <tr>
          <th rowspan="3">MemberService.chargeMemberCard</th>
          <td>语法</td>
          <td>public response chargeMemberCard(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户未拥有会员卡</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统进行会员卡购买操作</td>
        </tr>
        <tr>
          <th rowspan="3">MemberService.rechargeMemberCard</th>
          <td>语法</td>
          <td>public response rechargeMemberCard(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户拥有会员卡</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统进行会员卡充值，更新会员卡信息</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">FavorService</td>
        </tr>
        <tr>
          <th rowspan="3">FavorService.selectMovieFavorList</th>
          <td>语法</td>
          <td>public response selectMovieFavorList(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>普通用户登陆</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回用户想看电影列表</td>
        </tr>
        <tr>
          <th rowspan="3">FavorService.selectMovieFavorNum</th>
          <td>语法</td>
          <td>public response selectMovieFavorNum(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>该电影存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回想看该电影的人数</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">MovieArrangeService</td>
        </tr>
        <tr>
          <th rowspan="3">MovieArrangeService.selectMovieSchedule</th>
          <td>语法</td>
          <td>public response selectMovieSchedule(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>电影已被排片</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回排片记录</td>
        </tr>
        <tr>
          <th rowspan="3">MovieArrangeService.addMovieSchedule</th>
          <td>语法</td>
          <td>public response addMovieSchedule(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员操作，所要排片的电影存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统插入排片记录</td>
        </tr>
        <tr>
          <th rowspan="3">MovieArrangeService.updateMovieSchedule</th>
          <td>语法</td>
          <td>public response updateMovieSchedule(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员操作，所要排片的电影存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统修改排片记录</td>
        </tr>
        <tr>
          <th rowspan="3">MovieArrangeService.removeMovieSchedule</th>
          <td>语法</td>
          <td>public response removeMovieSchedule(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>管理员操作，拍片电影到达下架时间</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统删除排片记录</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">MovieSumService</td>
        </tr>
        <tr>
          <th rowspan="3">MovieSumService.getMostFavorable</th>
          <td>语法</td>
          <td>public response getMostFavorable(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户想要得到最受欢迎电影统计数据</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回最受欢迎电影统计数据</td>
        </tr>
        <tr>
          <th rowspan="3">MovieSumService.getPosistionRate</th>
          <td>语法</td>
          <td>public response getPosistionRate(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户想要得到电影上座率</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回电影上座率</td>
        </tr>
        <tr>
          <th rowspan="3">MovieSumService.getTicketAvePrice</th>
          <td>语法</td>
          <td>public response getTicketAvePrice(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户想要得到客单价</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回客单价</td>
        </tr>
        <tr>
          <th rowspan="3">MovieSumService.getMovieBills</th>
          <td>语法</td>
          <td>public response getMovieBills(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户想要得到电影票房，该电影存在并且上架</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回指定电影票房</td>
        </tr>
        <tr>
          <th rowspan="3">MovieSumService.getScheduleRate</th>
          <td>语法</td>
          <td>public response getScheduleRate(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户想要得到电影排片率，该电影存在并且上架</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回指定电影排片率</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">HallService</td>
        </tr>
        <tr>
          <th rowspan="3">HallService.getHallInfo</th>
          <td>语法</td>
          <td>public response getHallInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>影厅信息存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回影厅信息</td>
        </tr>
        <tr>
          <th rowspan="3">HallService.addHallRecord</th>
          <td>语法</td>
          <td>public response addHallRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>经理角色操作</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统添加影厅信息</td>
        </tr>
        <tr>
          <th rowspan="3">HallService.updateHallRecord</th>
          <td>语法</td>
          <td>public response updateHallRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>经理角色操作,影厅信息存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统修改影厅信息</td>
        </tr>
        <tr>
          <th rowspan="3">HallService.removeHallRecord</th>
          <td>语法</td>
          <td>public response removeHallRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>经理角色操作,影厅信息存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统删除影厅信息</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">TicketService</td>
        </tr>
        <tr>
          <th rowspan="3">TicketService.purchaseTicket</th>
          <td>语法</td>
          <td>public response purchaseTicket(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户角色操作，电影信息存在并且场次存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统添加购票信息，更新场次信息</td>
        </tr>
        <tr>
          <th rowspan="3">TicketService.getTicketInfo</th>
          <td>语法</td>
          <td>public response getTicketInfo(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户角色操作，用户已经进行购票操作</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回指定购票信息</td>
        </tr>
        <tr>
          <th rowspan="3">TicketService.getConsumptionRecord</th>
          <td>语法</td>
          <td>public response getConsumptionRecord(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户角色操作</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统返回用户消费记录</td>
        </tr>
        <tr>
          <th rowspan="3">TicketService.adoptPreferentialMethod</th>
          <td>语法</td>
          <td>public response adoptPreferentialMethod(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户角色操作,正在进行购票操作，用户拥有一种或多种优惠策略(优惠活动/会员卡)</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统进行购票票价更新</td>
        </tr>
        <tr>
          <th rowspan="3">TicketService.refundTicket</th>
          <td>语法</td>
          <td>public response refundTicket(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户角色操作,用户已经购票。</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统进行退票处理</td>
        </tr>

<table>
    	<tr>
            <th colspan="3">RoleService</td>
        </tr>
        <tr>
          <th rowspan="3">RoleService.getRoleList</th>
          <td>语法</td>
          <td>public response getRoleList(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>用户存在</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统得到用户的角色信息，便于之后的鉴权操作</td>
        </tr>
        <tr>
          <th rowspan="3">RoleService.updateRole</th>
          <td>语法</td>
          <td>public response updateRole(request)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>面向经理的接口</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>系统修改用户角色信息</td>
        </tr>


### 5.5 数据层分解

#### 5.5.1 职责

| 模块                            | 职责                                                         |
| ------------------------------- | ------------------------------------------------------------ |
| MovieData                       | 负责电影数据的保存、增、删、改、查服务                       |
| UserData                        | 持久化的数据接口，供集体载入、集体保存、增、删、改、查服务   |
| TheaterData                     | 持久化的数据接口，供集体载入、集体保存、增、删、改、查服务   |
| PromotionData                   | 负责优惠策略的设置、取消、查看服务                           |
| DataService                     | 持久化数据接口，提供集体载入、集体保存、增、删、改、查服务   |
| DataServiceSerializableFileImpl | 基于序列化文件的持久化数据库接口，提供集体载入、集体保存、增、删、改、查服务 |
| DataServiceMySqlImpl            | 基于MySql数据库的持久化数据库接口，提供集体载入、集体保存、增、删、改、查服务 |

数据访问层设计

![](<https://raw.githubusercontent.com/1071956678lfm/NJUSE-2/master/%E6%96%87%E6%A1%A3/img/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E5%B1%82%E8%AE%BE%E8%AE%A1.png>)

#### 5.5.2 数据层模块的接口规范

##### 5.5.2.1 MovieData模块接口规范

   <table>
        <tr>
            <th colspan="3">提供的服务（供接口）</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Movies.add</th>
          <td>语法</td>
          <td>public void add(movieInfoPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库不存在名称、编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>增加一个po</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Movies.delete</th>
          <td>语法</td>
          <td>public void delete(moiveInfoPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称、编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除一个po</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Movies.modify</th>
          <td>语法</td>
          <td>public void modify(movieInfoPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称、编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>更新一个po</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Movies.find</th>
          <td>语法</td>
          <td>public movieInfoPO find(String moiveID)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在相同id的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>根据关键字返回查找结果</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Ticket.add</th>
          <td>语法</td>
          <td>public void add(movieTicketPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库不存在名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>增加一个po</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Ticket.delete</th>
          <td>语法</td>
          <td>public void delete(movieTicketPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除一个po</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Ticket.modify</th>
          <td>语法</td>
          <td>public void modify(movieTicketPO po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改一个po</td>
        </tr>
        <tr>
          <th rowspan="3">MovieData.Ticket.find</th>
          <td>语法</td>
          <td>public iterator<movieTicketPO> find(String ticketID)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库中存在ID相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回对应的PO</td>
        </tr>
    </table>


##### 5.5.2.2 UserData模块的接口规范
<table>
		<tr>
          <th rowspan="3">UserData.user.add</th>
          <td>语法</td>
          <td>public void useradd(userPo  po )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库不存在编号、姓名相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>新增一个Po</td>
        </tr>
        <tr>
          <th rowspan="3">UserData.user.delete</th>
          <td>语法</td>
          <td>public void userdelete(userPo  po )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在编号或者姓名相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除一个Po</td>
        </tr>
        <tr>
          <th rowspan="3">UserData.user.modify</th>
          <td>语法</td>
          <td>public userPO usermodify(userPo  po , string id )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在编号或者姓名相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改一个Po</td>
        </tr>
        <tr>
          <th rowspan="3">UserData.user.find</th>
          <td>语法</td>
          <td>public iterator<userPo> userfind(string id )</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在编号或者姓名相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回一个Po信息</td>
        </tr>
    	<tr>
          <th rowspan="3">UserData.role.add</th>
          <td>语法</td>
          <td>public void roleadd(rolePo  po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库不存在ID、名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>新增一个PO</td>
        </tr>
        <tr>
          <th rowspan="3">UserData.role.delete</th>
          <td>语法</td>
          <td>public void roledelete(rolePo  po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在ID或者名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>删除一个PO</td>
        </tr>
        <tr>
          <th rowspan="3">UserData.role.modify</th>
          <td>语法</td>
          <td>public void rolemodify(rolePo  po , string id)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在ID或者名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>修改一个PO</td>
        </tr>
        <tr>
          <th rowspan="3">UserData.role.find</th>
          <td>语法</td>
          <td>public iterator<userPo> rolefind(string id)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在ID或者名称相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>返回一个PO信息</td>
        </tr>
</table>


##### 5.5.2.3 TheaterData模块的接口规范

<table>
 	<tr>
          <th rowspan="3">TheaterData.movieHall.add</th>
          <td>语法</td>
          <td>public void addHall(movieHallPo po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库不存在相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>数据库新增一个po</td>
        </tr>
        <tr>
          <th rowspan="3">TheaterData.movieHall.delete</th>
          <td>语法</td>
          <td>public void deleteHall(movieHallPo po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>数据库删除一个po</td>
        </tr>
        <tr>
          <th rowspan="3">TheaterData.movieHall.modify</th>
          <td>语法</td>
          <td>public void modifyHall(movieHallPo po)</td>
        </tr>
        <tr>
          <td>前置条件</td>
          <td>数据库存在编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>数据库更改一个po</td>
        </tr>
        <tr>
          <th rowspan="3">TheaterData.movieHall.find</th>
          <td>语法</td>
          <td>public void findHall(movieHallPo po)</td>
        </tr>
         <tr>
          <td>前置条件</td>
          <td>数据库存在编号相同的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>数据库返回一个po</td>
        </tr>
    	<tr>
          <th rowspan="3">TheaterData.timeSlot.set</th>
          <td>语法</td>
          <td>public void setTimeSlot(timeSlotPo po)</td>
        </tr>
         <tr>
          <td>前置条件</td>
          <td>数据库内存在需要排片的电影</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>数据库增加排片信息timeSlotPO</td>
        </tr>
    	<tr>
          <th rowspan="3">TheaterData.timeSlot.change</th>
          <td>语法</td>
          <td>public void changeTimeSlot(timeSlotPo po)</td>
        </tr>
         <tr>
          <td>前置条件</td>
          <td>数据库内存在对应的PO</td>
        </tr>
        <tr>
          <td>后置条件</td>
          <td>数据库修改排片信息timeSlotPO</td>
        </tr>
</table>


##### 5.5.2.4 PromotionData模块的接口规范
<table>
 	<tr>
       <th rowspan="3">PromotionData.preferential.add</th>
       <td>语法</td>
       <td>public void addpreferential(preferentialPo po)</td>
    </tr>
    <tr>
       <td>前置条件</td>
       <td>数据库不存在相同的PO</td>
    </tr>
    <tr>
       <td>后置条件</td>
       <td>数据库新增一个po</td>
    </tr>
    <tr>
       <th rowspan="3">PromotionData.preferential.cancel</th>
       <td>语法</td>
       <td>public void cancelpreferential(preferentialPo po)</td>
    </tr>
    <tr>
       <td>前置条件</td>
       <td>数据库存在对应的PO</td>
    </tr>
    <tr>
       <td>后置条件</td>
       <td>数据库删除一个po</td>
    </tr>
    <tr>
       <th rowspan="3">PromotionData.preferential.find</th>
       <td>语法</td>
       <td>public void cancelpreferential(preferentialPo po)</td>
    </tr>
    <tr>
       <td>前置条件</td>
       <td>数据库存在对应的PO</td>
    </tr>
    <tr>
       <td>后置条件</td>
       <td>数据库返回一个po</td>
    </tr>	
</table>


## 6. 信息视角

### 6.1 数据持久化对象

系统的PO类就是对应的相关实体类、在此只做简单介绍<br>

| PO               | 内容                                                         |
| ---------------- | ------------------------------------------------------------ |
| favorListPO      | 包含影片ID、用户ID                                           |
| mapperUserRolePO | 包含用户ID、角色ID                                           |
| memberListPO     | 包含用户ID、会员卡ID、余额、卡号、卡类型                     |
| movieHallPO      | 包含放映厅ID、放映厅名称、放映厅尺寸                         |
| movieInfoPO      | 包含影片名称、上映时间、评分、放映时长、总票房               |
| movieTicketPO    | 包含电影票ID、验证码、场次ID、座位号、优惠策略ID             |
| permissionPO     | 包含权限ID、内容、角色ID                                     |
| preferentialPO   | 包含优惠策略ID、策略名称、开始事件、结束时间                 |
| rolePO           | 包含角色ID、角色名称、会员逾期时间                           |
| timeSlotPO       | 包含电影场次ID、场次起点、电影ID、场次票价、对应放映厅、影片规格 |
| userPO           | 包含用户ID、密码                                             |
| userInfoPO       | 包含用户ID、名称、年龄                                       |

### 6.2 ser持久化格式

ser持久化就是将实体的PO序列化存储

### 6.3 数据库表

包含favorList表，mapperUserRole表，memberList表，movieHall表，movieInfo表，movieTicket表，permission表，preferential表，role表，timeSlot表，user表，userInfo表